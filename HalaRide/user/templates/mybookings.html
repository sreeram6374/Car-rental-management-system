{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Halaride - My Bookings</title>

    <link rel="stylesheet" href="{% static 'CSS/mybookings.css' %}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body>
    {% include 'include/user_navbar.html' %}

    <div class="px-5 mt-5">
      <h4 class="fw-bold py-2" style="margin-top: 100px">My Bookings</h4>

      <div class="table-responsive">
        <table class="table table-bordered text-center align-middle">
          <thead class="table-dark">
            <tr>
              <th>Customer Name</th>
              <th>Email</th>
              <th>Mobile</th>
              <th>License No</th>
              <th>License Image</th>
              <th>Car</th>
              <th>Car Image</th>
              <th>Booking Date</th>
              <th>Pickup</th>
              <th>Drop</th>
              <th>Total Hours</th>
              <th>Price/Hour</th>
              <th>Security Deposit</th>
              <th>Total Price</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>

          <tbody>
            {% for booking in my_book_data %}
            <tr>
              <td>{{ booking.customername }}</td>
              <td>{{ booking.email }}</td>
              <td>{{ booking.mobilenumber }}</td>
              <td>{{ booking.licencenumber }}</td>
              <td>
                {% if booking.licenceimage %}
                <img src="{{ booking.licenceimage.url }}" alt="License" style="width: 100px; height: 60px" />
                {% else %} No Image {% endif %}
              </td>
              {% if booking.CarDetails.carname %}
              <td>{{ booking.CarDetails.carname }}</td>
              {% else %}
              <td>{{ booking.carname }}</td>
              {% endif %}
              <td>
                {% if booking.CarDetails.image1 %}
                <img src="{{ booking.CarDetails.image1.url }}" alt="Car" style="width: 100px; height: 60px" />
                {% else %} 
                 <img src="{{ booking.image1.url }}" alt="Car" style="width: 100px; height: 60px" />
                {% endif %}
                
              </td>
              <td>{{ booking.bookingdate }}</td>
              <td>{{ booking.pickup_datetime|date:"d-m-Y H:i" }}</td>
              <td>{{ booking.drop_datetime|date:"d-m-Y H:i" }}</td>
              <td>{{ booking.total_hours }} hrs</td>
              {% if booking.CarDetails.price %}
              <td>₹{{ booking.CarDetails.price }}</td>
              <td>₹{{ booking.CarDetails.deposit }}</td>
              {% else %}
              <td>₹{{ booking.price }}</td>
              <td>₹{{ booking.deposit }}</td>
              {% endif %}
              <td>₹{{ booking.total_price }}</td>
              <td>
                <span class="badge 
                  {% if booking.status == 'Pending' %} bg-warning text-dark 
                  {% elif booking.status == 'Confirmed' %} bg-success 
                  {% elif booking.status == 'Cancelled' %} bg-danger 
                  {% elif booking.status == 'Completed' %} bg-info 
                  {% endif %}">
                  {{ booking.status }}
                </span>
              </td>
              <td>
                <a href="{% url 'cancelbooking' booking.id %}">
                  <div class="btn btn-danger">Cancel</div>
                </a>
              </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
      </div>
<hr>
            <!-- Cancelled Bookings -->
              <div class="table-responsive mt-5">
                <div class="h4 fw-bold">Cancelled Bookings</div>
        <table class="table table-bordered text-center align-middle">
          <thead class="table-dark">
            <tr>
              <th>Customer Name</th>
              <th>Email</th>
              <th>Mobile</th>
              <th>License No</th>
              <th>License Image</th>
              <th>Car</th>
              <th>Car Image</th>
              <th>Booking Date</th>
              <th>Pickup</th>
              <th>Drop</th>
              <th>Total Hours</th>
              <th>Price/Hour</th>
              <th>Security Deposit</th>
              <th>Total Price</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>

          <tbody>
            {% for booking in cancelled_data %}
            <tr style="background-color: #ccc; color: #777;">
              <td>{{ booking.customername }}</td>
              <td>{{ booking.email }}</td>
              <td>{{ booking.mobilenumber }}</td>
              <td>{{ booking.licencenumber }}</td>
              <td>
                {% if booking.licenceimage %}
                <img src="{{ booking.licenceimage.url }}" alt="License" style="width: 100px; height: 60px" />
                {% else %} No Image {% endif %}
              </td>
              <td>{{ booking.carname }}</td>
              <td>
  {% if booking.car_image1 %}
    <img src="{{ booking.car_image1.url }}" alt="Car" style="width: 100px; height: 60px" />
  {% else %}
    <span>No Image</span>
  {% endif %}
</td>
              <td>{{ booking.bookingdate }}</td>
              <td>{{ booking.pickup_datetime|date:"d-m-Y H:i" }}</td>
              <td>{{ booking.drop_datetime|date:"d-m-Y H:i" }}</td>
              <td>{{ booking.total_hours }} hrs</td>
              <td>₹{{ booking.price }}</td>
              <td>₹{{ booking.deposit }}</td>
              <td>₹{{ booking.total_price }}</td>
              <td>
                <span class="badge bg-danger">Cancelled</span>
              </td>
              <td>
                <div class="btn btn-secondary disabled">Cancelled</div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
